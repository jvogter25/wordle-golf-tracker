(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[953],{880:function(e,t,r){Promise.resolve().then(r.bind(r,480))},480:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return GroupDetailPage}});var s=r(7437),i=r(2265),n=r(1396),a=r.n(n),l=r(1344),o=r(2899);function GroupDetailPage(e){let{params:t}=e,{user:r,loading:n}=(0,l.useAuth)(),[c,d]=(0,i.useState)(null),[u,m]=(0,i.useState)(!0),[x,h]=(0,i.useState)(""),g=t.id;(0,i.useEffect)(()=>{r&&g&&fetchGroupDetails()},[r,g]);let fetchGroupDetails=async()=>{try{let{data:e,error:t}=await o.OQ.from("groups").select("*").eq("id",g).single();if(t)throw t;let{data:r,error:s}=await o.OQ.from("group_members").select("\n          *,\n          profiles (\n            id,\n            display_name,\n            email,\n            avatar_url\n          )\n        ").eq("group_id",g);if(s)throw s;d({...e,members:r})}catch(e){h("Error loading group: ".concat(e.message))}finally{m(!1)}},leaveGroup=async()=>{if(confirm("Are you sure you want to leave this group?"))try{let{error:e}=await o.OQ.from("group_members").delete().eq("group_id",g).eq("user_id",null==r?void 0:r.id);if(e)throw e;h("Left group successfully"),setTimeout(()=>{window.location.href="/groups"},1500)}catch(e){h("Error leaving group: ".concat(e.message))}};if(n||u)return(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-500 mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Loading group..."})]})});if(!r)return(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Please sign in"}),(0,s.jsx)(a(),{href:"/auth/login",className:"bg-primary-500 text-white px-6 py-3 rounded-lg hover:bg-primary-600",children:"Sign In"})]})});if(!c)return(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Group not found"}),(0,s.jsx)(a(),{href:"/groups",className:"bg-primary-500 text-white px-6 py-3 rounded-lg hover:bg-primary-600",children:"Back to Groups"})]})});let p=c.members.find(e=>e.user_id===r.id),f=(null==p?void 0:p.role)==="admin";return(0,s.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,s.jsxs)("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[(0,s.jsxs)("div",{className:"flex justify-between items-start mb-8",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:c.name}),c.description&&(0,s.jsx)("p",{className:"text-gray-600 mb-4",children:c.description}),(0,s.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[(0,s.jsxs)("span",{children:[c.members.length," members"]}),(0,s.jsxs)("span",{children:["Created ",new Date(c.created_at).toLocaleDateString()]})]})]}),(0,s.jsxs)("div",{className:"flex space-x-3",children:[(0,s.jsx)(a(),{href:"/leaderboard?group=".concat(c.id),className:"bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600",children:"Leaderboard"}),(0,s.jsx)(a(),{href:"/submit",className:"bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600",children:"Submit Score"})]})]}),x&&(0,s.jsx)("div",{className:"mb-6 p-4 rounded-lg ".concat(x.includes("Error")?"bg-red-50 text-red-700":"bg-green-50 text-green-700"),children:x}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Invite Code"}),(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)("code",{className:"bg-gray-100 px-4 py-2 rounded text-lg font-mono",children:c.invite_code}),(0,s.jsx)("button",{onClick:()=>{(null==c?void 0:c.invite_code)&&(navigator.clipboard.writeText(c.invite_code),h("Invite code copied to clipboard!"),setTimeout(()=>h(""),3e3))},className:"bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600",children:"Copy"})]}),(0,s.jsx)("p",{className:"text-gray-600 text-sm mt-2",children:"Share this code with others to invite them to the group."})]}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Members"}),(0,s.jsx)("div",{className:"space-y-3",children:c.members.map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[e.profiles.avatar_url?(0,s.jsx)("img",{src:e.profiles.avatar_url,alt:e.profiles.display_name||e.profiles.email,className:"w-10 h-10 rounded-full object-cover"}):(0,s.jsx)("div",{className:"w-10 h-10 bg-primary-500 rounded-full flex items-center justify-center text-white font-semibold",children:(e.profiles.display_name||e.profiles.email||"U")[0].toUpperCase()}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-medium text-gray-900",children:e.profiles.display_name||e.profiles.email}),(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:["Joined ",new Date(e.joined_at).toLocaleDateString()]})]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium ".concat("admin"===e.role?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800"),children:e.role}),e.user_id===r.id&&(0,s.jsx)("span",{className:"text-xs text-gray-500",children:"(You)"})]})]},e.id))})]}),(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)(a(),{href:"/groups",className:"text-primary-500 hover:text-primary-600",children:"← Back to Groups"}),!f&&(0,s.jsx)("button",{onClick:leaveGroup,className:"bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600",children:"Leave Group"})]})]})})}},1344:function(e,t,r){"use strict";r.r(t),r.d(t,{AuthProvider:function(){return AuthProvider},useAuth:function(){return useAuth}});var s=r(7437),i=r(2265),n=r(2899);let a=(0,i.createContext)({user:null,session:null,loading:!0,signOut:async()=>{}});function AuthProvider(e){let{children:t}=e,[r,l]=(0,i.useState)(null),[o,c]=(0,i.useState)(null),[d,u]=(0,i.useState)(!0),[m,x]=(0,i.useState)(!1);(0,i.useEffect)(()=>{x(!0)},[]),(0,i.useEffect)(()=>{if(!m)return;n.OQ.auth.getSession().then(e=>{var t;let{data:{session:r}}=e;c(r),l(null!==(t=null==r?void 0:r.user)&&void 0!==t?t:null),u(!1)});let{data:{subscription:e}}=n.OQ.auth.onAuthStateChange(async(e,t)=>{var r;c(t),l(null!==(r=null==t?void 0:t.user)&&void 0!==r?r:null),u(!1)}),t=setInterval(async()=>{let e=await (0,n.eR)();e.isValid&&e.timeUntilExpiry<216e5&&(console.log("Refreshing session automatically..."),await (0,n.dx)())},432e5);return()=>{e.unsubscribe(),clearInterval(t)}},[m]);let signOut=async()=>{try{await n.OQ.auth.signOut()}catch(e){console.error("Error signing out:",e)}};return m?(0,s.jsx)(a.Provider,{value:{user:r,session:o,loading:d,signOut},children:t}):(0,s.jsx)("div",{className:"min-h-screen bg-blue-50 flex items-center justify-center",children:(0,s.jsx)("div",{className:"text-xl text-gray-600",children:"Loading..."})})}let useAuth=()=>{let e=(0,i.useContext)(a);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},2899:function(e,t,r){"use strict";r.d(t,{OQ:function(){return l},dx:function(){return refreshSession},eR:function(){return getSessionStatus}});var s=r(2362),i=r(2601);let n=i.env.NEXT_PUBLIC_SUPABASE_URL||"https://xneavnttdgrpltmmldit.supabase.co",a=i.env.NEXT_PUBLIC_SUPABASE_ANON_KEY||"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InhuZWF2bnR0ZGdycGx0bW1sZGl0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDk2NTk3ODksImV4cCI6MjA2NTIzNTc4OX0.2T3VMVWWn7g-m8iYcoHq8r5ZkM8rWtLEZ2RXWttw3AA";if(!n||!a)throw Error("Missing Supabase environment variables");let l=(0,s.eI)(n,a,{auth:{storage:{getItem:e=>window.localStorage.getItem(e),setItem:(e,t)=>{window.localStorage.setItem(e,t)},removeItem:e=>{window.localStorage.removeItem(e)}},autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,storageKey:"wordle-golf-session",flowType:"pkce"},global:{headers:{"X-Client-Info":"wordle-golf-tracker"}}}),refreshSession=async()=>{try{let{data:e,error:t}=await l.auth.refreshSession();if(t)return console.log("Session refresh error:",t.message),!1;return!0}catch(e){return console.log("Session refresh failed:",e),!1}},getSessionStatus=async()=>{try{let{data:{session:e}}=await l.auth.getSession();return{isValid:!!e,expiresAt:null==e?void 0:e.expires_at,refreshToken:null==e?void 0:e.refresh_token,timeUntilExpiry:(null==e?void 0:e.expires_at)?1e3*e.expires_at-Date.now():0}}catch(e){return{isValid:!1,expiresAt:null,refreshToken:null,timeUntilExpiry:0}}}},1396:function(e,t,r){e.exports=r(8326)}},function(e){e.O(0,[553,326,971,472,744],function(){return e(e.s=880)}),_N_E=e.O()}]);
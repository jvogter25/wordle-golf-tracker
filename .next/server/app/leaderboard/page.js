(()=>{var e={};e.id=173,e.ids=[173],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},2361:e=>{"use strict";e.exports=require("events")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},1808:e=>{"use strict";e.exports=require("net")},5477:e=>{"use strict";e.exports=require("punycode")},2781:e=>{"use strict";e.exports=require("stream")},4404:e=>{"use strict";e.exports=require("tls")},7310:e=>{"use strict";e.exports=require("url")},9796:e=>{"use strict";e.exports=require("zlib")},1140:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>i.a,__next_app__:()=>m,originalPathname:()=>x,pages:()=>c,routeModule:()=>p,tree:()=>d});var a=t(7096),s=t(6132),l=t(7284),i=t.n(l),o=t(2564),n={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(n[e]=()=>o[e]);t.d(r,n);let d=["",{children:["leaderboard",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,7635)),"/Users/jvogter25/Desktop/Wordle Golf Tracker/app/leaderboard/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,5641)),"/Users/jvogter25/Desktop/Wordle Golf Tracker/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,9291,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/jvogter25/Desktop/Wordle Golf Tracker/app/leaderboard/page.tsx"],x="/leaderboard/page",m={require:t,loadChunk:()=>Promise.resolve()},p=new a.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/leaderboard/page",pathname:"/leaderboard",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},1917:(e,r,t)=>{Promise.resolve().then(t.bind(t,1732))},1732:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>LeaderboardPage});var a=t(784),s=t(9885),l=t(1440),i=t.n(l),o=t(5527),n=t(9708);function LeaderboardPage(){let{user:e,loading:r}=(0,o.useAuth)(),[t,l]=(0,s.useState)(!0),[d,c]=(0,s.useState)([]),[x,m]=(0,s.useState)([]),[p,u]=(0,s.useState)(""),[g,h]=(0,s.useState)("net"),[b,f]=(0,s.useState)("");(0,s.useEffect)(()=>{e&&fetchUserGroups()},[e]),(0,s.useEffect)(()=>{p&&fetchLeaderboard()},[p,g]);let getNextMonthStart=e=>{let r=new Date(e+"-01");return r.setMonth(r.getMonth()+1),r.toISOString().slice(0,7)+"-01"},fetchUserGroups=async()=>{try{let{data:r,error:t}=await n.OQ.from("group_members").select("groups(*)").eq("user_id",e?.id);if(t)throw t;let a=r.map(e=>e.groups).filter(Boolean);m(a),1===a.length&&u(a[0].id)}catch(e){}},fetchLeaderboard=async()=>{if(p){l(!0);try{let e=new Date,r=e.toISOString().slice(0,7),{data:t,error:a}=await n.OQ.from("scores").select(`
          *,
          profiles (display_name, email, avatar_url)
        `).eq("group_id",p).gte("puzzle_date",`${r}-01`).lt("puzzle_date",`${getNextMonthStart(r)}`).order("puzzle_date",{ascending:!0});if(a)throw a;let{data:s,error:l}=await n.OQ.from("handicaps").select("*").eq("group_id",p);if(l)throw l;let i=new Map;t?.forEach(e=>{let r=e.user_id,t=e.profiles?.display_name||e.profiles?.email||"Unknown",a=e.profiles?.avatar_url;if(!i.has(r)){let e=s?.find(e=>e.user_id===r)?.current_handicap||0;i.set(r,{userId:r,name:t,avatar:a,totalRaw:0,totalNet:0,gamesPlayed:0,handicap:e,scores:[]})}let l=i.get(r),o=s?.find(e=>e.user_id===r)?.current_handicap||0;l.totalRaw+=e.raw_score,l.totalNet+=Math.max(-3,e.raw_score-o),l.gamesPlayed+=1,l.scores.push({date:e.puzzle_date,raw:e.raw_score,golf_score:e.golf_score,attempts:e.attempts})});let o=Array.from(i.values()).filter(e=>e.gamesPlayed>0).map(e=>({...e,avgRaw:e.totalRaw/e.gamesPlayed,avgNet:e.totalNet/e.gamesPlayed})).sort((e,r)=>"net"===g?e.avgNet-r.avgNet:e.avgRaw-r.avgRaw);c(o)}catch(e){f(`Error loading leaderboard: ${e.message}`)}finally{l(!1)}}},formatScore=e=>0===e?"E":e>0?`+${e.toFixed(1)}`:e.toFixed(1);return r?a.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-500 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Loading..."})]})}):e?a.jsx("div",{className:"min-h-screen bg-gray-50",children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Leaderboard"}),a.jsx("p",{className:"text-gray-600",children:"Current month rankings"})]}),b&&a.jsx("div",{className:"mb-6 p-4 rounded-lg bg-red-50 text-red-700 text-center",children:b}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[x.length>1&&(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Group"}),(0,a.jsxs)("select",{value:p,onChange:e=>u(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500",children:[a.jsx("option",{value:"",children:"Choose a group..."}),x.map(e=>a.jsx("option",{value:e.id,children:e.name},e.id))]})]}),(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"View Type"}),(0,a.jsxs)("div",{className:"flex rounded-lg border border-gray-300 overflow-hidden",children:[a.jsx("button",{onClick:()=>h("net"),className:`flex-1 px-4 py-2 text-sm font-medium ${"net"===g?"bg-primary-500 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,children:"Net Scores"}),a.jsx("button",{onClick:()=>h("raw"),className:`flex-1 px-4 py-2 text-sm font-medium ${"raw"===g?"bg-primary-500 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,children:"Raw Scores"})]})]})]}),t?(0,a.jsxs)("div",{className:"text-center py-8",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-500 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Loading leaderboard..."})]}):p?0===d.length?(0,a.jsxs)("div",{className:"text-center py-8",children:[a.jsx("div",{className:"text-4xl mb-4",children:"\uD83C\uDFCC️"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No scores yet"}),a.jsx("p",{className:"text-gray-600 mb-4",children:"Be the first to submit a score this month!"}),a.jsx(i(),{href:"/submit",className:"bg-primary-500 text-white px-6 py-3 rounded-lg hover:bg-primary-600",children:"Submit Score"})]}):a.jsx("div",{className:"space-y-4",children:d.map((r,t)=>(0,a.jsxs)("div",{className:`flex items-center justify-between p-4 rounded-lg border ${r.userId===e?.id?"border-primary-300 bg-primary-50":"border-gray-200 bg-gray-50"}`,children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[a.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center font-bold text-sm ${0===t?"bg-yellow-400 text-yellow-900":1===t?"bg-gray-300 text-gray-700":2===t?"bg-orange-400 text-orange-900":"bg-gray-200 text-gray-600"}`,children:t+1}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[r.avatar?a.jsx("img",{src:r.avatar,alt:r.name,className:"w-10 h-10 rounded-full object-cover"}):a.jsx("div",{className:"w-10 h-10 rounded-full bg-primary-500 flex items-center justify-center text-white font-semibold",children:r.name[0].toUpperCase()}),(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"font-semibold text-gray-900",children:r.name}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:[r.gamesPlayed," game",1!==r.gamesPlayed?"s":""," played","net"===g&&` • ${r.handicap.toFixed(1)} handicap`]})]})]})]}),(0,a.jsxs)("div",{className:"text-right",children:[a.jsx("div",{className:"text-xl font-bold text-gray-900",children:formatScore("net"===g?r.avgNet:r.avgRaw)}),a.jsx("div",{className:"text-sm text-gray-600",children:"net"===g?"Net Average":"Raw Average"})]})]},r.userId))}):a.jsx("div",{className:"text-center py-8",children:a.jsx("p",{className:"text-gray-600",children:"Please select a group to view the leaderboard"})})]}),(0,a.jsxs)("div",{className:"text-center space-x-4",children:[a.jsx(i(),{href:"/groups",className:"text-primary-500 hover:text-primary-600",children:"← Back to Groups"}),a.jsx(i(),{href:"/submit",className:"text-primary-500 hover:text-primary-600",children:"Submit Score →"})]})]})}):a.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Please sign in"}),a.jsx(i(),{href:"/auth/login",className:"bg-primary-500 text-white px-6 py-3 rounded-lg hover:bg-primary-600",children:"Sign In"})]})})}},7635:(e,r,t)=>{"use strict";t.r(r),t.d(r,{$$typeof:()=>i,__esModule:()=>l,default:()=>n});var a=t(5153);let s=(0,a.createProxy)(String.raw`/Users/jvogter25/Desktop/Wordle Golf Tracker/app/leaderboard/page.tsx`),{__esModule:l,$$typeof:i}=s,o=s.default,n=o},1440:(e,r,t)=>{e.exports=t(614)}};var r=require("../../webpack-runtime.js");r.C(e);var __webpack_exec__=e=>r(r.s=e),t=r.X(0,[790,614,688],()=>__webpack_exec__(1140));module.exports=t})();